CREATE TABLE BOOKS_AUD (
  EVENT_ID INT(11) NOT NULL AUTO_INCREMENT,
  EVENT_DATE DATETIME NOT NULL,
  EVENT_TYPE VARCHAR(50) DEFAULT NULL,
  BOOK_ID int(11) NOT NULL,
  OLD_BOOK_ID INT(11) DEFAULT NULL,
  NEW_BOOK_ID INT(11) DEFAULT NULL,
  OLD_TITLE VARCHAR(50) DEFAULT NULL,
  NEW_TITLE VARCHAR(50) DEFAULT NULL,
  OLD_PUBYEAR DATETIME DEFAULT NULL,
  NEW_PUBYEAR DATETIME DEFAULT NULL
  PRIMARY KEY (`EVENT_ID`)
)


DROP TRIGGER IF EXISTS BOOKS_INSERT;

DELIMITER $$

CREATE TRIGGER BOOKS_INSERT AFTER INSERT ON BOOKS
FOR EACH ROW
BEGIN

	INSERT INTO BOOKS_AUD (EVENT_DATE, EVENT_TYPE, BOOK_ID, NEW_BOOK_ID, NEW_TITLE,
    NEW_PUBYEAR)
    VALUES (CURTIME(), "INSERT", BOOK_ID, NEW.BOOK_ID, NEW.TITLE, NEW.PUBYEAR);
END $$

DELIMITER ;


DROP TRIGGER IF EXISTS BOOKS_DELETE;

DELIMITER $$

CREATE TRIGGER BOOKS_DELETE AFTER DELETE ON BOOKS
FOR EACH ROW
BEGIN

	INSERT INTO BOOKS_AUD (EVENT_DATE, EVENT_TYPE, BOOK_ID)
    VALUES (CURTIME(), "DELETE", OLD.BOOK_ID);
END $$

DELIMITER ;


DROP TRIGGER IF EXISTS BOOKS_UPDATE;

DELIMITER $$

CREATE TRIGGER BOOKS_UPDATE AFTER UPDATE ON BOOKS
FOR EACH ROW
BEGIN

	INSERT INTO BOOKS_AUD (EVENT_DATE, EVENT_TYPE, BOOK_ID, NEW_BOOK_ID, NEW_TITLE, NEW_PUBYEAR,
							OLD_BOOK_ID, OLD_TITLE, OLD_PUBYEAR)
    VALUES (CURTIME(), "UPDATE", OLD.BOOK_ID, NEW.BOOK_ID, NEW.TITLE, NEW.PUBYEAR,
			OLD.BOOK_ID, OLD.TITLE, OLD.PUBYEAR);
END $$

DELIMITER ;